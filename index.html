<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Portfolio</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
  <div class="header">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Ibeshaho Amini</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
            <li class="nav-item"><a class="nav-link" href="#blog">Blog</a></li>
            <li class="nav-item"><a class="nav-link" href="#projects">Work</a></li>
            <li class="nav-item"><a class="nav-link" href="#footer">Contact</a></li>
          </ul>
          <button class="btn btn-primary">Let's Talk</button>
        </div>
      </div>
    </nav>
  </div>

  <div>
    <div class="headerss" id="first">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-6 text-section">
            <h3>Hey There,</h3><h3>I'm Ibeshaho Amini.</h3>
            <p>welcome to my creative corner, I'm Ibeshaho Amini, a<br> 
            passionate Software Engineer, experienced in Java,<br> 
            web development, mobile dev, and<br> 
            data development.</p>
            <br>
            <button>Contact me</button>
            <button>My Work</button>
          </div>
          <div class="col-md-6 image-section">
            <img src="img/1693476739453.jpg" alt="Profile Picture" class="img-fluid">
          </div>
        </div>
      </div>
    </div>

    <div class="projects" id="projects">
      <h3><center>Recent Projects</center></h3>
      <div class="image-wrapper">
        <div class="images-container">
          <img src="img/6.jpg" alt="Project 1">
        </div>
        <div class="images-container">
          <img src="img/2.jpg" alt="Project 1">
        </div>
        <div class="images-container">
          <img src="img/3.png" alt="Project 1">
        </div>
        <!-- Add more project items as needed -->
      </div>
    </div>

    <div class="hero-section" id="about">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-6 text-section">
            <p>
              I am a dedicated and versatile software engineer with extensive experience 
              in designing and developing projects across multiple platforms, including web, 
              desktop, and mobile applications. My expertise in React, Java, C#, JavaScript, 
              and mobile app development has allowed me to create dynamic, user-friendly applications 
              that meet diverse client needs. <br><br>
              With a strong foundation in both front-end and back-end 
              development, I excel at building seamless user interfaces and robust server-side solutions. 
              My passion for technology and problem-solving drives me to continuously learn and innovate, 
              ensuring that my projects are always at the cutting edge of the industry.
            </p>
            <br>
            <button>Contact me</button>
            <button>Contact me</button>
          </div>
          <div class="col-md-6 image-section">
            <img src="img/prof-removebg-preview.png" alt="Profile Picture" class="img-fluid">
          </div>
        </div>
      </div>
    </div>

    <div class="container my-5" id="blog">
      <h3 class="text-center mb-4">Blogs</h3>
      <div class="row row-cols-1 row-cols-md-3 g-4" id="blogContainer">
        <!-- Blog cards will be inserted here by JavaScript -->
      </div>
    </div>

    <div class="modal fade" id="commentsModal" tabindex="-1" aria-labelledby="commentsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="commentsModalLabel">Comments</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <ul id="commentsList" class="list-group mb-3">
                <!-- Comments will be inserted here by JavaScript -->
              </ul>
              <p id="noCommentsMessage" class="text-muted" style="display: none;">No comments on this blog. Be the first to comment!</p>
              <form id="commentForm">
                <div class="mb-3">
                  <textarea class="form-control" id="commentText" rows="3" placeholder="Add a comment"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Post Comment</button>
              </form>
            </div>
          </div>
        </div>
      </div>



    <div class="col-md-12" id="footer">
      <div class="col-md-6" id="first">
        <div class="social-icons">
          <a href="#"><img src="img/fbb.png" alt="Facebook"></a>
          <a href="#"><img src="img/insta.jpg" alt="Instagram"></a>
          <a href="#"><img src="img/twii.png" alt="Twitter"></a>
        </div>
        <a href="#">Contact Us</a><br>
        <a href="adminiPanel.html">Admin Panel</a><br>
      </div>
      <div class="col-md-6" id="second">
        <p>Subscribe to Updates</p>
        <input type="text" placeholder="Email Address"><br>
        <button>Subscribe Now</button>
        <div class="copy">
          <p>@2024 Ibeshaho Amini</p>
        </div>
      </div>
    </div>
  </div>
<!-- Comment Modal -->
<div class="modal fade" id="commentModal" tabindex="-1" aria-labelledby="commentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="commentModalLabel">Comments</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Comments will be displayed here -->
                <div id="commentsContainer" class="comments-container mb-3"></div>
                <!-- Add Comment Form -->
                <form id="addCommentForm">
                    <div class="mb-3">
                        <label for="commentContent" class="form-label">Add a comment</label>
                        <textarea class="form-control" id="commentContent" rows="2" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Post</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    const apiBaseUrl = 'https://backend-6-w9mf.onrender.com/api';
    const loginPageUrl = 'https://your-frontend-url.com/login'; // Update with your login page URL

    // Fetch blogs from the API
    async function fetchBlogs() {
        try {
            const response = await fetch(`${apiBaseUrl}/blogs`);
            if (!response.ok) {
                throw new Error('Failed to fetch blogs');
            }
            const blogs = await response.json();
            displayBlogs(blogs);
        } catch (error) {
            console.error('Error fetching blogs:', error);
        }
    }

    // Display blogs
    function displayBlogs(blogs) {
        const blogContainer = document.getElementById('blogContainer');
        blogContainer.innerHTML = ''; // Clear previous content

        blogs.forEach(blog => {
            const isLiked = blog.isLikedByUser ? 'btn-danger' : 'btn-light';
            const blogCard = `
                <div class="col">
                    <div class="card h-100">
                        <img src="${blog.image}" class="card-img-top" alt="Blog Image">
                        <div class="card-body">
                            <h5 class="card-title">${blog.title}</h5>
                            <p class="card-text">${blog.content.substring(0, 100)}...</p>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn ${isLiked}" data-id="${blog._id}" onclick="likeBlog('${blog._id}', this)">
                                    <i class="fas fa-heart"></i> ${blog.likes || 0} Likes
                                </button>
                                <button class="btn btn-light" data-id="${blog._id}" onclick="openCommentModal('${blog._id}')">
                                    <i class="fas fa-comments"></i> Comment
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            blogContainer.innerHTML += blogCard;
        });
    }

    // Like a blog
    function likeBlog(blogId) {
        const token = localStorage.getItem('token');

        fetch(`${apiBaseUrl}/blogs/${blogId}/likes`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${token}` // Use Bearer token
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to like blog');
            }
            const likeButton = document.querySelector(`button[data-id='${blogId}'] .fas.fa-heart`);
            likeButton.style.color = 'red';
        })
        .catch(error => console.error('Error liking blog:', error));
    }

    // Load comments for a blog
    async function loadComments(blogId) {
        try {
            const response = await fetch(`${apiBaseUrl}/blogs/${blogId}/comments`);
            const comments = await response.json();
            displayComments(comments);
        } catch (error) {
            console.error('Error loading comments:', error);
        }
    }

    // Display comments
    function displayComments(comments) {
        const commentsContainer = document.getElementById('commentsContainer');
        commentsContainer.innerHTML = ''; // Clear previous comments
        comments.forEach(comment => {
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            commentDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <i class="bi bi-person comment-icon"></i>
                    <div class="comment-body ms-2">
                        <div class="comment-author">${comment.author?.email || 'Anonymous'}</div>
                        <div class="comment-text">${comment.content}</div>
                        <div class="comment-time">${new Date(comment.timestamp).toLocaleString()}</div>
                    </div>
                </div>
            `;
            commentsContainer.appendChild(commentDiv);
        });
    }

    // Add comment
    async function addComment(blogId, commentContent) {
        const token = localStorage.getItem('token'); // Fetch token

        try {
            const response = await fetch(`${apiBaseUrl}/blogs/${blogId}/comments`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${token}`, // Use Bearer token
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ content: commentContent })
            });

            if (response.ok) {
                loadComments(blogId);
                const modalElement = document.getElementById('commentModal');
                const modal = bootstrap.Modal.getInstance(modalElement); // Close modal using Bootstrap API
                modal.hide(); // Hide modal after comment is added
            } else {
                console.error('Failed to add comment');
            }
        } catch (error) {
            console.error('Error adding comment:', error);
        }
    }

    // Open comment modal
    function openCommentModal(blogId) {
        const modalElement = document.getElementById('commentModal');
        const modal = new bootstrap.Modal(modalElement); // Use Bootstrap modal API
        modal.show(); // Show modal

        document.getElementById('addCommentForm').onsubmit = function(event) {
            event.preventDefault();
            const commentContent = document.getElementById('commentContent').value.trim();
            if (commentContent) {
                addComment(blogId, commentContent);
            }
        };

        loadComments(blogId); // Load comments when modal opens
    }

    // Fetch blogs when the page loads
    window.onload = fetchBlogs;
</script>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap JS (for modal functionality) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<!-- Optional: jQuery (in case you're using it) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <!-- Include Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/css/bootstrap.min.css" rel="stylesheet">

<!-- Include Bootstrap JS and Popper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.1/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/js/bootstrap.min.js"></script>


